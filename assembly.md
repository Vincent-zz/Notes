# 汇编 

## 基础知识 

### 计算机基础 

主板（核心器件为CPU）控制接口卡（如显卡、网卡）控制外部器件（如显示器） 

**CPU -> 内存**： 
- 地址总线：在内存中寻找指定地址，n位地址总线 <=> n条线 <=> 宽度为n <=> 可以寻找2^n个内存单元（一内存单元 = 1 Byte），地址总线所能寻到的地址即为内存地址空间
- 控制总线：传输读、写等控制，越宽则能传输的控制越多，控制能力越强
- 数据总线：CPU与内存之间传送数据，越宽速度越快

三条总线与CPU内部输入输出控制器相连 

### 内存 

**内存的组成——存储器**:
- RAM：随机存储器（断电后数据会遗失）
- ROM：只读存储器（装有BIOS：Basic Input/Output System，硬件的基本输入输出程序，主板、某些接口卡都有这样的程序）
CPU通过地址总线连接主板、接口卡中的存储器 

所有内存单元构成的储存空间是一维线性的，且对于数据而言是从低位到高位的，例： 

`mov ax,0123H`这句汇编代码在内存中储存的形式是：B8（B8表示mov ax，假设此地址为10000），23（地址：10001），01（地址：10002）

此时，0123H为内存地址10001上储存的字型数据（1 word = 2 Byte） 

**段**： 

提高寻址能力，以8086（16位CPU）为例，8086有20位数据总线，CPU内部采用两个16位地址（段地址、偏移地址）通过地址加法器合成20位地址后输出到地址总线 

`内存地址 = 段地址 * 16 + 偏移地址`，可以表示为“段地址:偏移地址”的形式，同一个内存物理地址可以有多种分解方式 

### CPU 

**CPU的组成**：
- 运算器：n位CPU的运算器一次可处理n位的数据
- 控制器：控制CPU内各器件的工作
- 寄存器：n位CPU的通用寄存器宽度为n位，寄存器与运算器之间的通路是n位的
 
通过内部总线连接 

## 寄存器 

### 通用寄存器 

通用寄存器：AX、BX、CX、DX（16位，可存储一个字） 

两个独立8位寄存器使用（为了向下兼容），例如AX可以分为AH（high）、AL（low） 

### 段寄存器、指令指针寄存器 

段寄存器、指令指针寄存器：CS（code）、DS（data）、SS（stack）、ES（extra）；IP（instructor point，偏移地址的寄存器） 

CPU访问内存时由段寄存器提供地址 

**CS:IP** 

指令汇编代码储存在内存中，CPU利用CS:IP提供的地址合成指令代码入口处的内存物理地址（CS * 16 + IP），读入指令到指令缓冲器，CPU的执行控制器执行缓冲器中的指令，并且使CS:IP指向下一条指令代码的位置（IP += 所读取指令长度），循环往复 

通过转移指令jmp改变CS:IP的值： 

`jmp 段地址:偏移地址` 

仅改变IP的值（通过其他寄存器的值）： 

```
mov ax,偏移地址
jmp ax 
``` 

\* 开机时，CS:IP被初始化 

**DS** 

DS用于存放要访问的数据的段地址，搭配mov指令可以实现对内存中数据的读取和写入： 

```
mov bx,段地址
mov ds,bx
mov al,[偏移地址]   ; 读取一个内存单元的数据到al中
mov [偏移地址],al   ; 将al中的数据写入一个内存单元
mov ax,[偏移地址]   ; 读取指定地址的字型数据到ax中
mov [偏移地址],ax   ; 将ax中的字型数据写入指定地址
``` 

\* `mov`指令不支持直接将数据存入段寄存器